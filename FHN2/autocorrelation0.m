function Tau=autocorrelation0(data,tau_max)
%data:???????
%tau_max:??????
%Tau:?????????????
N=length(data);%??????
x_mean=mean(data);%????????
data=data-x_mean;
SSd=dot(data,data); %data??????
R_xx=zeros(1,tau_max);%????????
for tau=1:tau_max   %???????
    for ii=1:N-tau
        R_xx(tau)=R_xx(tau)+data(ii)*data(ii+tau);
    end
    R_xx(tau)=R_xx(tau)/SSd;
end
% plot(1:tau_max,R_xx);  hold on %???????
% line([1 tau_max],[0 0])
% title('?????????');
% ylabel('?????');
% xlabel('????');
Tau=0;
for jj=2:tau_max     %??????????  
    if R_xx(jj-1)*R_xx(jj)<=0
       if abs(R_xx(jj-1))>abs(R_xx(jj))
           Tau=jj;break
       else
           Tau=jj-1;break
       end
    end
end