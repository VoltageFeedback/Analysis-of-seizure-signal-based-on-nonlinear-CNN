function lambda_1=largest_lyapunov_exponent(data,m,tau,P)             

%???????????????lyapunov??
%data:????
%m:???
%tau:????
%P:?? FFT????????????
%lambda_1:?????????lyapunov???
N=length(data);  %????
delt_t=1;
Y=reconstitution0(data,m,tau );  %?????
M=N-(m-1)*tau;  %M?m??????????
d=zeros(M-1,M);
for j=1:M
    d_min=1e+100;
    for jj=1:M      %???????????????????????              
        if abs(j-jj)>P      %??????
            d_s=norm(Y(:,j)-Y(:,jj));%??????????
            if d_s<d_min
                d_min=d_s;
                idx_j=jj
            end           
        end
    end
    max_i=min((M-j),(M-idx_j));    %???j?????????i
    for k=1:max_i                 %???j???????i????????
       d(k,j)=norm(Y(:,j+k)-Y(:,idx_j+k));
    end
end
%?????????i?????j?lnd(i,j)??
[l_i,l_j]=size(d);
parfor i=1:l_i
    q=0;
    y_s=0;
    for j=1:l_j
        if d(i,j)~=0
            q=q+1;
            y_s=y_s+log(d(i,j));
        end
    end
    if q>0
      y(i)=y_s/(q*delt_t);
    end
end
x=1:length(y);
pp=polyfit(x,y,1);
lambda_1=pp(1);
yp=polyval(pp,x);
figure();
plot(x,y,'-')